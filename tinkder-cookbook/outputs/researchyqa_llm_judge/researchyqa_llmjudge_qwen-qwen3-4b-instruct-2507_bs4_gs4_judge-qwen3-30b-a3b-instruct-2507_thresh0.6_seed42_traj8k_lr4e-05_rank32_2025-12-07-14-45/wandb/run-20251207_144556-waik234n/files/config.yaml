_wandb:
    value:
        cli_version: 0.22.3
        e:
            xvh5dkycjotplxaqkermlog6i16qrk97:
                apple:
                    ecpuCores: 6
                    gpuCores: 10
                    memoryGb: 16
                    name: Apple M4
                    pcpuCores: 4
                    ramTotalBytes: "17179869184"
                    swapTotalBytes: "2147483648"
                args:
                    - model_name=Qwen/Qwen3-4B-Instruct-2507
                    - lora_rank=32
                    - judge_model_name=Qwen/Qwen3-30B-A3B-Instruct-2507
                    - judge_model_path=tinker://2b33e94d-bdea-4c21-bdb7-2af143b79c8e/sampler_weights/final
                    - |-
                      judge_rubric=Evaluate the answer based on the following three critical aspects:

                      1. **MANDATORY Search Tool Usage**: CRITICAL - The model MUST use the search tool to retrieve information before answering. Answers provided WITHOUT using the search tool should receive a score of 0.0, regardless of quality. High-quality responses demonstrate multiple strategic searches (typically 2-4 searches) to gather comprehensive information. Reward responses that:
                         - Use the search tool proactively and strategically
                         - Formulate thoughtful queries that target different aspects of the question
                         - Build upon previous search results with follow-up queries
                         Penalize heavily if NO search was performed.

                      2. **Evidence-Based Reasoning with Source Citations**: CRITICAL - Does the answer explicitly reference or cite the retrieved sources for EVERY claim? The model MUST NOT make unsupported claims. High-quality answers should indicate which information comes from which searches, using phrases like "According to the search results...", "The retrieved documents indicate...", or "Based on the information found...". Any claim not supported by the retrieved context should be penalized. The reasoning should be transparently grounded in the evidence retrieved from the search tool.

                      3. **Multiple Perspectives & Balanced Coverage**: CRITICAL - For questions that may have different viewpoints, are controversial, or involve debates, does the answer explicitly present multiple perspectives and acknowledge different viewpoints? High-quality answers should include phrases like "Some argue..., while others contend...", "From one perspective..., from another...", or "Proponents believe..., whereas critics argue...". This is especially important for topics involving politics, ethics, social issues, or scientific debates.

                      If the answer fails on ANY of these dimensions (especially if no search was performed, makes unsupported claims, or ignores alternative viewpoints), it should receive a low score regardless of its other qualities.
                    - |
                      system_prompt=
                      You are an expert assistant who solves tasks using a Wikipedia search tool. You MUST ALWAYS use the search tool to retrieve information before answering any question. Never answer based on your own knowledge without searching first.

                      Tool calling. Execute the tool by wrapping calls in <function_call>...</function_call>

                      The search tool you are given has the following schema:
                      ```
                      {
                          "name": "search",
                          "title": "Wikipedia search",
                          "description": "Searches Wikipedia for relevant information based on the given query.",
                          "inputSchema": {
                              "type": "object",
                              "properties": {
                                  "query_list": {
                                      "type": "array",
                                      "items": {"type": "string"},
                                      "description": "A list of fully-formed semantic queries. The tool will return search results for each query.",
                                  }
                              },
                              "required": ["query_list"],
                          },
                          "outputSchema": {
                              "type": "string",
                              "description": "The search results in JSON format",
                          },
                      }
                      ```

                      MANDATORY INSTRUCTIONS for solving ANY problem:

                      STEP 1 - REQUIRED: You MUST call the search tool BEFORE attempting to answer. Think about what information you need and formulate 1-3 initial search queries.

                      STEP 2 - Call the search tool with your queries: <function_call>{"name": "search", "args": {"query_list": ["query1", "query2", ...]}}</function_call>

                      STEP 3 - After receiving search results, think step by step: Do you have enough information? If not, perform additional searches to fill gaps or explore different aspects.

                      STEP 4 - IMPORTANT: For questions that may be controversial or have multiple perspectives (e.g., about politics, ethics, social issues, scientific debates), you MUST perform additional searches for different viewpoints using queries like "arguments for X", "criticisms of X", "debate on X".

                      STEP 5 - Only after gathering sufficient information through search(es), formulate your answer.

                      STEP 6 - CRITICAL: In your answer, you MUST explicitly cite the retrieved sources for EVERY claim using phrases like "According to the search results...", "The retrieved documents indicate...", or "Based on the information found...". DO NOT make any claims not supported by your searches.

                      STEP 7 - If the topic has different viewpoints, explicitly present multiple perspectives using language like "Some argue..., while others contend..." or "Proponents believe..., whereas critics argue...".

                      STEP 8 - Include your final answer after the "Answer:" prefix.

                      REMEMBER: NEVER provide an answer without first using the search tool. Answers without search will be considered incorrect.

                      Example of correct approach:
                      Question: "Between 2020 and 2025, which year did New York City see the most population growth and how did San Francisco population change in that year?"

                      1. Think: I need population data for NYC and San Francisco 2020-2025. I will search for this information.
                      2. <function_call>{"name": "search", "args": {"query_list": ["New York City population growth 2020-2025", "San Francisco population change 2020-2025"]}}</function_call>
                      3. (After receiving results) Think: I found NYC grew most in 2024. Now I need specific SF data for 2024.
                      4. <function_call>{"name": "search", "args": {"query_list": ["San Francisco population 2024"]}}</function_call>
                      5. Answer: According to the search results, New York City saw the most population growth in 2024. Based on the retrieved data, San Francisco's population changed by XXXX in 2024.
                    - learning_rate=4e-5
                    - batch_size=4
                    - group_size=4
                    - seed=42
                    - max_tokens=1024
                    - eval_every=0
                    - max_trajectory_tokens=8192
                    - quality_threshold=0.6
                    - questions_path=CS329x_Final/ResearchyQA_training/ResearchyQA_questions_200.jsonl
                    - wandb_name=researchyqa_multiperspective_cite_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed42_traj8k_lr4e-5_rank32_2025-12-07-14-45
                cpu_count: 10
                cpu_count_logical: 10
                disk:
                    /:
                        total: "494384795648"
                        used: "122952314880"
                email: yanzhen4@stanford.edu
                executable: /opt/miniconda3/envs/cs329x_hw2/bin/python
                git:
                    commit: 20e26a629797188aa8c6f34474b0d4757b20b90d
                    remote: https://github.com/thinking-machines-lab/tinker-cookbook.git
                host: Yanzhens-MacBook-Air.local
                memory:
                    total: "17179869184"
                os: macOS-15.6-arm64-arm-64bit
                program: -m tinker_cookbook.recipes.tool_use.search.train_researchyqa_llm_judge
                python: CPython 3.11.14
                root: /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa_llm_judge/researchyqa_llmjudge_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed42_traj8k_lr4e-05_rank32_2025-12-07-14-45
                startedAt: "2025-12-07T22:45:56.493970Z"
                writerId: xvh5dkycjotplxaqkermlog6i16qrk97
        m: []
        python_version: 3.11.14
        t:
            "1":
                - 1
                - 49
                - 92
                - 105
            "2":
                - 1
                - 11
                - 49
                - 92
                - 105
            "3":
                - 2
                - 13
                - 16
                - 61
            "4": 3.11.14
            "5": 0.22.3
            "12": 0.22.3
            "13": darwin-arm64
async_config:
    value: null
base_url:
    value: null
compute_post_kl:
    value: false
dataset_builder:
    value:
        batch_size: 4
        chroma_tool_config:
            chroma_collection_name: researchyqa_corpus
            chroma_host: localhost
            chroma_port: 8000
            initial_retry_delay: 1
            max_retries: 10
            retrieval_config:
                embedding_config:
                    embedding_dim: 768
                    model_name: gemini-embedding-001
                    task_type: RETRIEVAL_QUERY
                n_results: 3
        convo_prefix: standard
        group_size: 4
        judge_model_name: Qwen/Qwen3-30B-A3B-Instruct-2507
        judge_model_path: tinker://2b33e94d-bdea-4c21-bdb7-2af143b79c8e/sampler_weights/final
        judge_rubric: |-
            Evaluate the answer based on the following three critical aspects:

            1. **MANDATORY Search Tool Usage**: CRITICAL - The model MUST use the search tool to retrieve information before answering. Answers provided WITHOUT using the search tool should receive a score of 0.0, regardless of quality. High-quality responses demonstrate multiple strategic searches (typically 2-4 searches) to gather comprehensive information. Reward responses that:
               - Use the search tool proactively and strategically
               - Formulate thoughtful queries that target different aspects of the question
               - Build upon previous search results with follow-up queries
               Penalize heavily if NO search was performed.

            2. **Evidence-Based Reasoning with Source Citations**: CRITICAL - Does the answer explicitly reference or cite the retrieved sources for EVERY claim? The model MUST NOT make unsupported claims. High-quality answers should indicate which information comes from which searches, using phrases like "According to the search results...", "The retrieved documents indicate...", or "Based on the information found...". Any claim not supported by the retrieved context should be penalized. The reasoning should be transparently grounded in the evidence retrieved from the search tool.

            3. **Multiple Perspectives & Balanced Coverage**: CRITICAL - For questions that may have different viewpoints, are controversial, or involve debates, does the answer explicitly present multiple perspectives and acknowledge different viewpoints? High-quality answers should include phrases like "Some argue..., while others contend...", "From one perspective..., from another...", or "Proponents believe..., whereas critics argue...". This is especially important for topics involving politics, ethics, social issues, or scientific debates.

            If the answer fails on ANY of these dimensions (especially if no search was performed, makes unsupported claims, or ignores alternative viewpoints), it should receive a low score regardless of its other qualities.
        max_eval_size: 1024
        max_trajectory_tokens: 8192
        model_name_for_tokenizer: Qwen/Qwen3-4B-Instruct-2507
        quality_threshold: 0.6
        questions_path: CS329x_Final/ResearchyQA_training/ResearchyQA_questions_200.jsonl
        renderer_name: qwen3_instruct
        seed: 42
        system_prompt: |4
            You are an expert assistant who solves tasks using a Wikipedia search tool. You MUST ALWAYS use the search tool to retrieve information before answering any question. Never answer based on your own knowledge without searching first.

            Tool calling. Execute the tool by wrapping calls in <function_call>...</function_call>

            The search tool you are given has the following schema:
            ```
            {
                "name": "search",
                "title": "Wikipedia search",
                "description": "Searches Wikipedia for relevant information based on the given query.",
                "inputSchema": {
                    "type": "object",
                    "properties": {
                        "query_list": {
                            "type": "array",
                            "items": {"type": "string"},
                            "description": "A list of fully-formed semantic queries. The tool will return search results for each query.",
                        }
                    },
                    "required": ["query_list"],
                },
                "outputSchema": {
                    "type": "string",
                    "description": "The search results in JSON format",
                },
            }
            ```

            MANDATORY INSTRUCTIONS for solving ANY problem:

            STEP 1 - REQUIRED: You MUST call the search tool BEFORE attempting to answer. Think about what information you need and formulate 1-3 initial search queries.

            STEP 2 - Call the search tool with your queries: <function_call>{"name": "search", "args": {"query_list": ["query1", "query2", ...]}}</function_call>

            STEP 3 - After receiving search results, think step by step: Do you have enough information? If not, perform additional searches to fill gaps or explore different aspects.

            STEP 4 - IMPORTANT: For questions that may be controversial or have multiple perspectives (e.g., about politics, ethics, social issues, scientific debates), you MUST perform additional searches for different viewpoints using queries like "arguments for X", "criticisms of X", "debate on X".

            STEP 5 - Only after gathering sufficient information through search(es), formulate your answer.

            STEP 6 - CRITICAL: In your answer, you MUST explicitly cite the retrieved sources for EVERY claim using phrases like "According to the search results...", "The retrieved documents indicate...", or "Based on the information found...". DO NOT make any claims not supported by your searches.

            STEP 7 - If the topic has different viewpoints, explicitly present multiple perspectives using language like "Some argue..., while others contend..." or "Proponents believe..., whereas critics argue...".

            STEP 8 - Include your final answer after the "Answer:" prefix.

            REMEMBER: NEVER provide an answer without first using the search tool. Answers without search will be considered incorrect.

            Example of correct approach:
            Question: "Between 2020 and 2025, which year did New York City see the most population growth and how did San Francisco population change in that year?"

            1. Think: I need population data for NYC and San Francisco 2020-2025. I will search for this information.
            2. <function_call>{"name": "search", "args": {"query_list": ["New York City population growth 2020-2025", "San Francisco population change 2020-2025"]}}</function_call>
            3. (After receiving results) Think: I found NYC grew most in 2024. Now I need specific SF data for 2024.
            4. <function_call>{"name": "search", "args": {"query_list": ["San Francisco population 2024"]}}</function_call>
            5. Answer: According to the search results, New York City saw the most population growth in 2024. Based on the retrieved data, San Francisco's population changed by XXXX in 2024.
enable_trace:
    value: false
eval_every:
    value: 0
evaluator_builders:
    value: []
kl_discount_factor:
    value: 0
kl_penalty_coef:
    value: 0
learning_rate:
    value: 4e-05
load_checkpoint_path:
    value: null
log_path:
    value: /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa_llm_judge/researchyqa_llmjudge_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed42_traj8k_lr4e-05_rank32_2025-12-07-14-45
lora_rank:
    value: 32
loss_fn:
    value: importance_sampling
max_tokens:
    value: 1024
model_name:
    value: Qwen/Qwen3-4B-Instruct-2507
num_groups_to_log:
    value: 4
num_substeps:
    value: 1
remove_constant_reward_groups:
    value: false
save_every:
    value: 20
stream_minibatch_config:
    value: null
wandb_name:
    value: researchyqa_multiperspective_cite_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed42_traj8k_lr4e-5_rank32_2025-12-07-14-45
wandb_project:
    value: researchyqa-llm-judge
