[34m[1mwandb[0m: Detected [google.genai] in use.
[34m[1mwandb[0m: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
[34m[1mwandb[0m: For more information, check out the docs at: https://weave-docs.wandb.ai/
tinker_cookbook.utils.ml_log:475 [[92mINFO[0m] Logging to: /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa_llm_judge/researchyqa_llmjudge_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-58
tinker_cookbook.checkpoint_utils:19 [[92mINFO[0m] No checkpoints found at /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa_llm_judge/researchyqa_llmjudge_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-58/checkpoints.jsonl
tinker_cookbook.checkpoint_utils:48 [[92mINFO[0m] No checkpoints found with key state_path in /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa_llm_judge/researchyqa_llmjudge_qwen-qwen3-4b-instruct-2507_bs4_gs4_judge-qwen3-30b-a3b-instruct-2507_thresh0.6_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-58
tinker.lib.public_interfaces.service_client:61 [[92mINFO[0m] ServiceClient initialized for session c4e1033c-6b15-5478-bc34-2ceb1a109eef
tinker.lib.public_interfaces.service_client:126 [[92mINFO[0m] Creating TrainingClient for model_id='c4e1033c-6b15-5478-bc34-2ceb1a109eef:train:0'
tinker.lib.public_interfaces.service_client:61 [[92mINFO[0m] ServiceClient initialized for session 330e3157-5a53-538e-97f5-f1125f53dbbe
tinker_cookbook.recipes.tool_use.search.researchyqa_llm_judge_env:372 [[92mINFO[0m] Loaded 80 questions for train split
tinker_cookbook.rl.train:1081 [[92mINFO[0m] Will train on 20 batches
tinker_cookbook.utils.misc_utils:20 [[92mINFO[0m] Starting save_checkpoint
tinker_cookbook.utils.misc_utils:23 [[92mINFO[0m] save_checkpoint took 12.09 seconds
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/recipes/tool_use/search/train_researchyqa_llm_judge.py", line 245, in <module>
    asyncio.run(cli_main(cli_config))
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/recipes/tool_use/search/train_researchyqa_llm_judge.py", line 240, in cli_main
    await train.main(config)
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/utils/trace.py", line 332, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/rl/train.py", line 1090, in main
    await training_func(
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/utils/trace.py", line 332, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/rl/train.py", line 1009, in do_sync_training
    sampling_client, train_step_metrics = await do_train_step_and_get_sampling_client(
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/utils/trace.py", line 332, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/rl/train.py", line 907, in do_train_step_and_get_sampling_client
    data_D, prepare_minibatch_metrics = await prepare_minibatch(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/utils/trace.py", line 332, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/rl/train.py", line 717, in prepare_minibatch
    metrics.update(compute_trajectory_metrics(trajectory_groups_P, taglist_P))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/rl/metric_util.py", line 54, in compute_trajectory_metrics
    {f"env/all/{k}": v for k, v in _compute_trajectory_metrics(trajectory_groups_P).items()}
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/rl/metric_util.py", line 90, in _compute_trajectory_metrics
    metrics.update(dict_mean(transition_metrics + traj_metrics))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/utils/misc_utils.py", line 35, in dict_mean
    return {k: float(np.mean(values)) for k, values in key2values.items()}
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/tinker_cookbook/utils/misc_utils.py", line 35, in <dictcomp>
    return {k: float(np.mean(values)) for k, values in key2values.items()}
                     ^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/numpy/_core/fromnumeric.py", line 3860, in mean
    return _methods._mean(a, axis=axis, dtype=dtype,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/numpy/_core/_methods.py", line 134, in _mean
    ret = umr_sum(arr, axis, dtype, out, keepdims, where=where)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: the resolved dtypes are not compatible with add.reduce. Resolved (dtype('<U19'), dtype('<U19'), dtype('<U38'))
