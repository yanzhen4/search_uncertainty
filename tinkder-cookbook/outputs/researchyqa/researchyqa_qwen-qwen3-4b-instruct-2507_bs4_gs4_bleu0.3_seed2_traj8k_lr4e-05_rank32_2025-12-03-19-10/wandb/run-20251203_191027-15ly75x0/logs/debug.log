2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_setup.py:_flush():81] Current SDK version is 0.22.3
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_setup.py:_flush():81] Configure stats pid to 34051
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_setup.py:_flush():81] Loading settings from /Users/yanzhenshen/.config/wandb/settings
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_setup.py:_flush():81] Loading settings from /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/wandb/settings
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_setup.py:_flush():81] Loading settings from environment variables
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_init.py:setup_run_log_directory():706] Logging user logs to /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa/researchyqa_qwen-qwen3-4b-instruct-2507_bs4_gs4_bleu0.3_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-10/wandb/run-20251203_191027-15ly75x0/logs/debug.log
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_init.py:setup_run_log_directory():707] Logging internal logs to /Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa/researchyqa_qwen-qwen3-4b-instruct-2507_bs4_gs4_bleu0.3_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-10/wandb/run-20251203_191027-15ly75x0/logs/debug-internal.log
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_init.py:init():833] calling init triggers
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_init.py:init():838] wandb.init called with sweep_config: {}
config: {'learning_rate': 4e-05, 'dataset_builder': {'batch_size': 4, 'group_size': 4, 'model_name_for_tokenizer': 'Qwen/Qwen3-4B-Instruct-2507', 'renderer_name': 'qwen3_instruct', 'chroma_tool_config': {'chroma_host': 'localhost', 'chroma_port': 8000, 'chroma_collection_name': 'researchyqa_corpus', 'retrieval_config': {'n_results': 3, 'embedding_config': {'model_name': 'gemini-embedding-001', 'embedding_dim': 768, 'task_type': 'RETRIEVAL_QUERY'}}, 'max_retries': 10, 'initial_retry_delay': 1}, 'convo_prefix': 'standard', 'seed': 2, 'max_eval_size': 1024, 'max_trajectory_tokens': 8192, 'bleu_threshold': 0.3, 'questions_path': 'CS329x_Final/ResearchyQA/ResearchyQA_questions_with_answers_100.jsonl'}, 'model_name': 'Qwen/Qwen3-4B-Instruct-2507', 'max_tokens': 1024, 'compute_post_kl': False, 'evaluator_builders': [], 'lora_rank': 32, 'kl_penalty_coef': 0.0, 'kl_discount_factor': 0.0, 'loss_fn': 'importance_sampling', 'num_substeps': 1, 'wandb_project': 'researchyqa-training', 'wandb_name': 'researchyqa_qwen-qwen3-4b-instruct-2507_bs4_gs4_bleu0.3_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-10', 'log_path': '/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa/researchyqa_qwen-qwen3-4b-instruct-2507_bs4_gs4_bleu0.3_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-10', 'base_url': None, 'enable_trace': False, 'remove_constant_reward_groups': False, 'eval_every': 0, 'save_every': 20, 'load_checkpoint_path': None, 'async_config': None, 'stream_minibatch_config': None, 'num_groups_to_log': 4, '_wandb': {}}
2025-12-03 19:10:27,077 INFO    MainThread:34051 [wandb_init.py:init():881] starting backend
2025-12-03 19:10:27,313 INFO    MainThread:34051 [wandb_init.py:init():884] sending inform_init request
2025-12-03 19:10:27,342 INFO    MainThread:34051 [wandb_init.py:init():892] backend started and connected
2025-12-03 19:10:27,344 INFO    MainThread:34051 [wandb_init.py:init():962] updated telemetry
2025-12-03 19:10:27,363 INFO    MainThread:34051 [wandb_init.py:init():986] communicating run to backend with 90.0 second timeout
2025-12-03 19:10:28,323 INFO    MainThread:34051 [wandb_init.py:init():1033] starting run threads in backend
2025-12-03 19:10:28,406 INFO    MainThread:34051 [wandb_run.py:_console_start():2506] atexit reg
2025-12-03 19:10:28,406 INFO    MainThread:34051 [wandb_run.py:_redirect():2354] redirect: wrap_raw
2025-12-03 19:10:28,406 INFO    MainThread:34051 [wandb_run.py:_redirect():2423] Wrapping output streams.
2025-12-03 19:10:28,406 INFO    MainThread:34051 [wandb_run.py:_redirect():2446] Redirects installed.
2025-12-03 19:10:28,407 INFO    MainThread:34051 [wandb_init.py:init():1073] run started, returning control to user process
2025-12-03 19:10:28,459 INFO    MainThread:34051 [wandb_run.py:_config_callback():1390] config_cb None None {'learning_rate': 4e-05, 'dataset_builder': {'batch_size': 4, 'group_size': 4, 'model_name_for_tokenizer': 'Qwen/Qwen3-4B-Instruct-2507', 'renderer_name': 'qwen3_instruct', 'chroma_tool_config': {'chroma_host': 'localhost', 'chroma_port': 8000, 'chroma_collection_name': 'researchyqa_corpus', 'retrieval_config': {'n_results': 3, 'embedding_config': {'model_name': 'gemini-embedding-001', 'embedding_dim': 768, 'task_type': 'RETRIEVAL_QUERY'}}, 'max_retries': 10, 'initial_retry_delay': 1}, 'convo_prefix': 'standard', 'seed': 2, 'max_eval_size': 1024, 'max_trajectory_tokens': 8192, 'bleu_threshold': 0.3, 'questions_path': 'CS329x_Final/ResearchyQA/ResearchyQA_questions_with_answers_100.jsonl'}, 'model_name': 'Qwen/Qwen3-4B-Instruct-2507', 'max_tokens': 1024, 'compute_post_kl': False, 'evaluator_builders': [], 'lora_rank': 32, 'kl_penalty_coef': 0.0, 'kl_discount_factor': 0.0, 'loss_fn': 'importance_sampling', 'num_substeps': 1, 'wandb_project': 'researchyqa-training', 'wandb_name': 'researchyqa_qwen-qwen3-4b-instruct-2507_bs4_gs4_bleu0.3_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-10', 'log_path': '/Users/yanzhenshen/Desktop/CS329x/tinker-cookbook/outputs/researchyqa/researchyqa_qwen-qwen3-4b-instruct-2507_bs4_gs4_bleu0.3_seed2_traj8k_lr4e-05_rank32_2025-12-03-19-10', 'base_url': None, 'enable_trace': False, 'remove_constant_reward_groups': False, 'eval_every': 0, 'save_every': 20, 'load_checkpoint_path': None, 'async_config': None, 'stream_minibatch_config': None, 'num_groups_to_log': 4}
2025-12-03 19:10:52,303 INFO    wandb-AsyncioManager-main:34051 [service_client.py:_forward_responses():80] Reached EOF.
2025-12-03 19:10:52,303 INFO    wandb-AsyncioManager-main:34051 [mailbox.py:close():137] Closing mailbox, abandoning 1 handles.
2025-12-03 19:10:52,585 ERROR   wandb-AsyncioManager-main:34051 [asyncio_manager.py:fn_wrap_exceptions():183] Uncaught exception in run_soon callback.
Traceback (most recent call last):
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 392, in drain
    await self._protocol._drain_helper()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 166, in _drain_helper
    raise ConnectionResetError('Connection lost')
ConnectionResetError: Connection lost
2025-12-03 19:10:52,592 ERROR   wandb-AsyncioManager-main:34051 [asyncio_manager.py:fn_wrap_exceptions():183] Uncaught exception in run_soon callback.
Traceback (most recent call last):
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 392, in drain
    await self._protocol._drain_helper()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 166, in _drain_helper
    raise ConnectionResetError('Connection lost')
ConnectionResetError: Connection lost
2025-12-03 19:10:52,592 ERROR   wandb-AsyncioManager-main:34051 [asyncio_manager.py:fn_wrap_exceptions():183] Uncaught exception in run_soon callback.
Traceback (most recent call last):
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 392, in drain
    await self._protocol._drain_helper()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 166, in _drain_helper
    raise ConnectionResetError('Connection lost')
ConnectionResetError: Connection lost
2025-12-03 19:10:52,595 ERROR   wandb-AsyncioManager-main:34051 [asyncio_manager.py:fn_wrap_exceptions():183] Uncaught exception in run_soon callback.
Traceback (most recent call last):
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 392, in drain
    await self._protocol._drain_helper()
  File "/opt/miniconda3/envs/cs329x_hw2/lib/python3.11/asyncio/streams.py", line 166, in _drain_helper
    raise ConnectionResetError('Connection lost')
ConnectionResetError: Connection lost
